# ao CLI Reference

> Auto-generated by `scripts/generate-cli-reference.sh` on 2026-02-23 (UTC).
> Do not edit manually. Re-run the script to update.

## Global Flags

          --config string   Config file (default: ~/.agentops/config.yaml)
          --dry-run         Show what would happen without executing
      -h, --help            help for ao
      -o, --output string   Output format (json, table, yaml) (default "table")
      -v, --verbose         Enable verbose output

---

## Commands

### `ao demo`

Run an interactive demonstration of AgentOps capabilities.

```
ao demo [flags]
```

**Flags:**

```
      --concepts   Just explain core concepts
  -h, --help       help for demo
      --quick      2-minute quick overview
```

---

### `ao init`

Set up a repository for AgentOps: directories, gitignore, and optional hooks.

```
ao init [flags]
```

**Flags:**

```
      --full            With --hooks, explicitly request full coverage (legacy explicit flag)
  -h, --help            help for init
      --hooks           Also register hooks (full 12-event coverage by default; equivalent to ao hooks install --full)
      --minimal-hooks   With --hooks, install only SessionStart + Stop hooks
      --stealth         Use .git/info/exclude instead of .gitignore
```

---

### `ao quick-start`

Initialize AgentOps in your current project.

```
ao quick-start [flags]
```

**Flags:**

```
  -h, --help       help for quick-start
      --minimal    Minimal setup (just directories)
      --no-beads   Skip beads initialization
```

---

### `ao badge`

Display a visual badge showing knowledge flywheel health status.

```
ao badge [flags]
```

---

### `ao doctor`

Run health checks on your AgentOps installation.

```
ao doctor [flags]
```

**Flags:**

```
  -h, --help   help for doctor
      --json   Output results as JSON
```

---

### `ao forge`

The forge command extracts knowledge candidates from various sources.

```
ao forge [command]
```

**Subcommands:**

#### `ao forge batch`

Find and process pending transcripts in bulk.

```
ao forge batch [flags]
```

**Flags:**

```
      --dir string   Specific directory to scan (default: all Claude project dirs)
      --extract      Trigger extraction after forging
  -h, --help         help for batch
      --max int      Maximum transcripts to process (0 = all)
```

#### `ao forge markdown`

Parse markdown (.md) files and extract knowledge candidates.

```
ao forge markdown <path-or-glob> [flags]
```

**Flags:**

```
  -h, --help    help for markdown
      --queue   Queue for learning extraction at next session start
      --quiet   Suppress all output (for hooks)
```

#### `ao forge transcript`

Parse Claude Code JSONL transcript files and extract knowledge candidates.

```
ao forge transcript <path-or-glob> [flags]
```

**Flags:**

```
  -h, --help           help for transcript
      --last-session   Process only the most recent transcript
      --queue          Queue session for learning extraction at next session start
      --quiet          Suppress all output (for hooks)
```

---

### `ao gate`

Manage human review gates for bronze-tier candidates.

```
ao gate [command]
```

**Subcommands:**

#### `ao gate approve`

Approve a bronze-tier candidate for promotion.

```
ao gate approve <candidate-id> [flags]
```

**Flags:**

```
  -h, --help          help for approve
      --note string   Optional approval note
```

#### `ao gate bulk-approve`

Approve all silver-tier candidates older than a threshold.

```
ao gate bulk-approve [flags]
```

**Flags:**

```
  -h, --help                help for bulk-approve
      --older-than string   Age threshold for bulk approval (default "24h")
      --tier string         Tier to bulk approve (default: silver) (default "silver")
```

#### `ao gate pending`

List bronze-tier candidates awaiting human review.

```
ao gate pending [flags]
```

#### `ao gate reject`

Reject a candidate with a required reason.

```
ao gate reject <candidate-id> [flags]
```

**Flags:**

```
  -h, --help            help for reject
      --reason string   Required rejection reason
```

---

### `ao pool`

Manage knowledge candidates in quality pools.

```
ao pool [command]
```

**Subcommands:**

#### `ao pool auto-promote`

Automatically approve (and optionally promote) high-quality candidates

```
ao pool auto-promote [flags]
```

**Flags:**

```
  -h, --help               help for auto-promote
      --include-gold       Include gold-tier candidates when using --promote (default true)
      --promote            Also stage+promote eligible candidates into .agents/ (not just approval)
      --threshold string   Minimum age for auto-promotion (default: 24h) (default "24h")
```

#### `ao pool batch-promote`

Promote pending pool candidates that meet promotion criteria.

```
ao pool batch-promote [flags]
```

**Flags:**

```
  --dry-run   Show what would be promoted without executing
  --force     Promote all pending candidates regardless of criteria
  --min-age   Minimum age threshold (default: 24h)
      --force            Promote all pending regardless of criteria
  -h, --help             help for batch-promote
      --min-age string   Minimum age for promotion eligibility (default "24h")
```

#### `ao pool ingest`

Ingest pending learnings into the quality pool.

```
ao pool ingest [<files-or-globs...>] [flags]
```

**Flags:**

```
      --dir string   Directory to ingest from when no args are provided (default ".agents/knowledge/pending")
  -h, --help         help for ingest
```

#### `ao pool list`

List knowledge candidates filtered by tier and/or status.

```
ao pool list [flags]
```

**Flags:**

```
  -h, --help            help for list
      --limit int       Maximum results to return (default 50, 0 for unlimited) (default 50)
      --offset int      Skip first N results (for pagination)
      --status string   Filter by status (pending, staged, promoted, rejected)
      --tier string     Filter by tier (gold, silver, bronze)
  -w, --wide            Show full IDs without truncation
```

#### `ao pool migrate-legacy`

Move legacy knowledge captures from .agents/knowledge/*.md into

```
ao pool migrate-legacy [flags]
```

**Flags:**

```
  -h, --help                 help for migrate-legacy
      --pending-dir string   Pending directory for migrated captures (default ".agents/knowledge/pending")
      --source-dir string    Source directory containing legacy markdown captures (default ".agents/knowledge")
```

#### `ao pool promote`

Move a staged candidate to the knowledge base (.agents/learnings/ or .agents/patterns/).

```
ao pool promote <candidate-id> [flags]
```

#### `ao pool reject`

Mark a candidate as rejected and move to rejected directory.

```
ao pool reject <candidate-id> [flags]
```

**Flags:**

```
  -h, --help            help for reject
      --reason string   Reason for rejection (required)
```

#### `ao pool show`

Show detailed information about a pool candidate.

```
ao pool show <candidate-id> [flags]
```

#### `ao pool stage`

Move a candidate from pending to staged status.

```
ao pool stage <candidate-id> [flags]
```

**Flags:**

```
  -h, --help              help for stage
      --min-tier string   Minimum tier threshold (default: bronze)
```

---

### `ao search`

Search AgentOps knowledge using file-based search.

```
ao search <query> [flags]
```

**Flags:**

```
      --cass          Enable CASS session-aware search with maturity weighting
  -h, --help          help for search
      --limit int     Maximum results to return (default 10)
      --type string   Filter by type: decisions, knowledge, sessions
      --use-sc        Enable Smart Connections semantic search (requires Obsidian)
```

---

### `ao status`

Display the current state of AgentOps knowledge base.

```
ao status [flags]
```

---

### `ao version`

Display the version, build information, and runtime details.

```
ao version [flags]
```

---

### `ao vibe-check`

Run a comprehensive vibe-check analysis on your repository.

```
ao vibe-check [flags]
```

**Flags:**

```
      --full           Show all metrics and findings (verbose)
  -h, --help           help for vibe-check
      --markdown       Output as markdown report
      --repo string    Path to git repository (default ".")
      --since string   Time window for analysis (e.g., 7d, 30d, 90d) (default "7d")
```

---

### `ao goals`

Track, measure, and validate project fitness goals.

```
ao goals [command]
```

**Flags:**

```
      --file string   Path to goals file (default "GOALS.yaml")
  -h, --help          help for goals
      --json          Output as JSON
      --timeout int   Check timeout in seconds (default 30)
```

**Subcommands:**

#### `ao goals measure`

Run goal checks and produce a snapshot

```
ao goals measure [flags]
```

**Flags:**

```
      --goal string   Measure a single goal by ID
  -h, --help          help for measure
```

#### `ao goals validate`

Validate GOALS.yaml structure and wiring

```
ao goals validate [flags]
```

#### `ao goals drift`

Compare snapshots for regressions

```
ao goals drift [flags]
```

**Flags:**

```
  -h, --help           help for drift
      --since string   Compare against snapshot from this date (YYYY-MM-DD)
```

#### `ao goals export`

Export latest snapshot as JSON (for CI)

```
ao goals export [flags]
```

#### `ao goals history`

Show goal measurement history

```
ao goals history [flags]
```

**Flags:**

```
      --goal string    Filter history to a specific goal
  -h, --help           help for history
      --since string   Show entries since date (YYYY-MM-DD)
```

#### `ao goals add`

Add a new goal to GOALS.yaml

```
ao goals add <id> <check-command> [flags]
```

**Flags:**

```
      --description string   Goal description
  -h, --help                 help for add
      --type string          Goal type (health, architecture, quality, meta)
      --weight int           Goal weight (1-10) (default 5)
```

#### `ao goals meta`

Run and report meta-goals only

```
ao goals meta [flags]
```

#### `ao goals migrate`

Migrate a version 1 GOALS.yaml to version 2 format.

```
ao goals migrate [flags]
```

---

### `ao plans`

Plans manages the plan manifest at .agents/plans/manifest.jsonl.

```
ao plans [command]
```

**Subcommands:**

#### `ao plans diff`

Diff compares the plan manifest against beads reality.

```
ao plans diff [flags]
```

#### `ao plans list`

List shows all plans in the manifest.

```
ao plans list [flags]
```

**Flags:**

```
  -h, --help             help for list
      --project string   Filter by project path
      --status string    Filter by status (active, completed, abandoned, superseded)
```

#### `ao plans register`

Register adds a plan to the manifest.jsonl for discovery.

```
ao plans register <plan-path> [flags]
```

**Flags:**

```
      --beads-id string   Beads issue/epic ID this plan implements
  -h, --help              help for register
      --name string       Human-readable plan name
      --project string    Project path this plan applies to
```

#### `ao plans search`

Search plans by name or project

```
ao plans search <query> [flags]
```

#### `ao plans sync`

Sync pulls plan metadata from beads to prevent drift.

```
ao plans sync [flags]
```

#### `ao plans update`

Update a plan's status or metadata

```
ao plans update <plan-path> [flags]
```

**Flags:**

```
      --beads-id string   Update beads ID
  -h, --help              help for update
      --status string     New status for the plan
```

---

### `ao ratchet`

Track progress through the RPI (Research-Plan-Implement) workflow.

```
ao ratchet [command]
```

**Subcommands:**

#### `ao ratchet check`

Check if prerequisites are satisfied for a workflow step.

```
ao ratchet check <step> [flags]
```

#### `ao ratchet next`

Show the next pending step in the RPI workflow.

```
ao ratchet next [flags]
```

**Flags:**

```
      --epic string   Filter by epic ID
  -h, --help          help for next
```

#### `ao ratchet spec`

Find and output the current spec artifact path.

```
ao ratchet spec [flags]
```

#### `ao ratchet status`

Display the current state of the ratchet chain.

```
ao ratchet status [flags]
```

**Flags:**

```
      --chain string   Filter by chain ID
      --epic string    Filter by epic ID
  -h, --help           help for status
```

#### `ao ratchet validate`

Validate that an artifact meets quality requirements.

```
ao ratchet validate <step> [flags]
```

**Flags:**

```
      --changes strings      Files to validate
  -h, --help                 help for validate
      --lenient              Allow legacy artifacts without schema_version (expires in 90 days)
      --lenient-expiry int   Days until lenient bypass expires (default 90)
```

#### `ao ratchet promote`

Record promotion of an artifact to a higher tier.

```
ao ratchet promote <artifact> [flags]
```

**Flags:**

```
  -h, --help     help for promote
      --to int   Target tier (0-4, required) (default -1)
```

#### `ao ratchet record`

Record that a workflow step has been completed.

```
ao ratchet record <step> [flags]
```

**Flags:**

```
      --cycle int            RPI cycle number (1 for first, 2+ for iterations)
  -h, --help                 help for record
      --input string         Input artifact path
      --lock                 Lock the step (engage ratchet) (default true)
      --output string        Output artifact path (required)
      --parent-epic string   Parent epic ID from prior RPI cycle
      --tier int             Quality tier (0-4) (default -1)
```

#### `ao ratchet skip`

Record that a step was intentionally skipped.

```
ao ratchet skip <step> [flags]
```

**Flags:**

```
  -h, --help            help for skip
      --reason string   Reason for skipping (required)
```

#### `ao ratchet find`

Search for artifacts across all locations.

```
ao ratchet find <pattern> [flags]
```

#### `ao ratchet trace`

Trace an artifact back through the ratchet chain.

```
ao ratchet trace <artifact> [flags]
```

#### `ao ratchet migrate`

Migrate chain from legacy YAML format to JSONL.

```
ao ratchet migrate [flags]
```

#### `ao ratchet migrate-artifacts`

Add schema_version: 1 to existing .agents/ artifacts.

```
ao ratchet migrate-artifacts [path] [flags]
```

---

### `ao rpi`

Commands for automating the RPI (Research-Plan-Implement) lifecycle.

```
ao rpi [command]
```

**Subcommands:**

#### `ao rpi cancel`

Cancel active RPI orchestration runs via a CLI kill switch.

```
ao rpi cancel [flags]
```

**Flags:**

```
      --all             Cancel all active runs discovered under current/sibling roots
      --dry-run         Show what would be cancelled without sending signals
  -h, --help            help for cancel
      --run-id string   Cancel one active run by run ID
      --signal string   Signal to send: TERM|KILL|INT (default "TERM")
```

#### `ao rpi cleanup`

Detect and clean up stale RPI phased runs.

```
ao rpi cleanup [flags]
```

**Flags:**

```
      --all                    Clean up all stale runs
      --dry-run                Show what would be done without making changes
  -h, --help                   help for cleanup
      --prune-branches         Delete legacy RPI branches (rpi/*, codex/auto-rpi-*)
      --prune-worktrees        Run 'git worktree prune' after cleanup
      --run-id string          Clean up a specific run by ID
      --stale-after duration   Only clean runs older than this age (0 disables age filtering)
```

#### `ao rpi loop`

Execute RPI cycles in a loop, consuming from next-work.jsonl.

```
ao rpi loop [goal] [flags]
```

**Flags:**

```
      --auto-clean                        Run stale RPI cleanup before each phased cycle
      --auto-clean-stale-after duration   Only auto-clean runs older than this age (default 24h0m0s)
      --bd-sync-policy string             bd sync policy for landing: auto|always|never (default "auto")
      --cleanup-prune-branches            Run legacy branch cleanup during supervisor cleanup
      --cleanup-prune-worktrees           Run git worktree prune during supervisor cleanup (default true)
      --command-timeout duration          Timeout for supervisor external commands (git/bd/gate scripts) (default 20m0s)
      --cycle-delay duration              Delay between completed cycles
      --cycle-retries int                 Automatic retry count per cycle after a failed attempt
      --detached-branch-prefix string     Branch prefix used by detached HEAD self-heal (default "codex/auto-rpi")
      --detached-heal                     Auto-create/switch to a named branch when HEAD is detached
      --ensure-cleanup                    Run stale-run cleanup after each cycle (cleanup guarantee)
      --failure-policy string             Cycle failure policy: stop|continue (default "stop")
      --gate-fast-script string           Fast validation gate script path (default "scripts/validate-go-fast.sh")
      --gate-policy string                Quality/security gate policy: off|best-effort|required (default "off")
      --gate-security-script string       Security gate script path (default "scripts/security-gate.sh")
  -h, --help                              help for loop
      --kill-switch-path string           Supervisor kill-switch file path checked at cycle boundaries (absolute or repo-relative) (default ".agents/rpi/KILL")
      --landing-branch string             Landing target branch (empty resolves origin/HEAD, then current branch, then main)
      --landing-commit-message string     Commit message template for landing policies that commit (default "chore(rpi): autonomous cycle {{cycle}}")
      --landing-lock-path string          Landing lock file path for synchronized integration (absolute or repo-relative) (default ".agents/rpi/landing.lock")
      --landing-policy string             Landing policy after successful cycle: off|commit|sync-push (default "off")
      --lease                             Acquire a single-flight supervisor lease lock before running
      --lease-path string                 Lease lock file path (absolute or repo-relative) (default ".agents/rpi/supervisor.lock")
      --lease-ttl duration                Lease heartbeat TTL for supervisor lock metadata (default 2m0s)
      --max-cycles int                    Maximum cycles (0 = unlimited, stop when queue empty)
      --repo-filter string                Only process queue items targeting this repo (empty = all)
      --retry-backoff duration            Backoff between cycle retry attempts (default 30s)
      --supervisor                        Enable autonomous supervisor mode (lease lock, self-heal, retries, gates, cleanup)
```

#### `ao rpi phased`

Orchestrate the full RPI lifecycle using 3 consolidated phases.

```
ao rpi phased <goal> [flags]
```

**Flags:**

```
      --auto-clean-stale                  Run stale-run cleanup before starting phased execution
      --auto-clean-stale-after duration   Only clean stale runs older than this age when auto-clean is enabled (default 24h0m0s)
      --fast-path                         Force fast path (--quick for gates)
      --from string                       Start from phase (discovery, implementation, validation; aliases: research, plan, pre-mortem, crank, vibe, post-mortem) (default "discovery")
  -h, --help                              help for phased
      --interactive                       Enable human gates at research and plan phases
      --live-status                       Stream phase progress to a live-status.md file
      --max-retries int                   Maximum retry attempts per gate (default: 3) (default 3)
      --no-worktree                       Disable worktree isolation (run in current directory)
      --phase-timeout duration            Maximum wall-clock runtime per phase (0 disables timeout) (default 1h30m0s)
      --runtime string                    Phase runtime mode: auto|direct|stream (default "auto")
      --runtime-cmd string                Runtime command to execute prompts (must support '-p') (default "claude")
      --stall-timeout duration            Maximum time without progress before declaring stall (0 disables) (default 10m0s)
      --stream-startup-timeout duration   Maximum time to wait for first stream event before falling back to direct execution (0 disables) (default 45s)
      --swarm-first                       Default each phase to swarm/agent-team execution; fall back to direct execution if swarm runtime is unavailable (default true)
      --test-first                        Pass --test-first to /crank for spec-first TDD
```

#### `ao rpi status`

Display active and recent RPI phased runs.

```
ao rpi status [flags]
```

**Flags:**

```
  -h, --help    help for status
      --watch   Poll every 5s and redraw (Ctrl-C to exit)
```

#### `ao rpi verify`

Verify integrity of the RPI ledger.

```
ao rpi verify [flags]
```

---

### `ao session`

Session lifecycle operations.

```
ao session [command]
```

**Subcommands:**

#### `ao session close`

Close a session by forging its transcript, extracting learnings,

```
ao session close [flags]
```

**Flags:**

```
  -h, --help             help for close
      --session string   Session ID to close (default: most recent transcript)
```

---

### `ao completion`

Generate shell completion scripts for ao.

```
ao completion [bash|zsh|fish]
```

---

### `ao config`

View and manage AgentOps configuration.

```
ao config [flags]
```

**Flags:**

```
  -h, --help   help for config
      --show   Show resolved configuration with sources
```

---

### `ao hooks`

The hooks command manages Claude Code hooks that automate the CASS knowledge flywheel.

```
ao hooks [command]
```

**Subcommands:**

#### `ao hooks init`

Generate Claude Code hooks configuration for the CASS knowledge flywheel.

```
ao hooks init [flags]
```

**Flags:**

```
      --format string   Output format: json, shell (default "json")
  -h, --help            help for init
```

#### `ao hooks install`

Install ao hooks to ~/.claude/settings.json.

```
ao hooks install [flags]
```

**Flags:**

```
      --dry-run             Show what would be installed without making changes
      --force               Overwrite existing ao hooks
      --full                Install all hook events from hooks.json with scripts copied to ~/.agentops/
  -h, --help                help for install
      --source-dir string   Path to agentops repo checkout (for --full script installation)
```

#### `ao hooks show`

Display the current Claude Code hooks configuration from ~/.claude/settings.json.

```
ao hooks show [flags]
```

#### `ao hooks test`

Test that all hook dependencies are available and working.

```
ao hooks test [flags]
```

**Flags:**

```
      --dry-run   Show test steps without running hooks
  -h, --help      help for test
```

---

### `ao inbox`

View messages from the Agent Farm.

```
ao inbox [flags]
```

**Flags:**

```
      --from string    Filter by sender
  -h, --help           help for inbox
      --limit int      Maximum messages to display (0 for all) (default 100)
      --mark-read      Mark displayed messages as read
      --since string   Show messages from last duration (e.g., 5m, 1h)
      --unread         Show only unread messages
```

---

### `ao mail`

Inter-agent messaging for the Agent Farm.

```
ao mail [command]
```

**Subcommands:**

#### `ao mail send`

Send a message to another agent or the mayor.

```
ao mail send [flags]
```

**Flags:**

```
      --body string   Message body
  -h, --help          help for send
      --to string     Recipient (mayor, witness, agent-N)
      --type string   Message type (progress, completion, blocker, farm_complete) (default "progress")
```

---

### `ao anti-patterns`

List learnings that have been marked as anti-patterns.

```
ao anti-patterns [flags]
```

---

### `ao flywheel`

Knowledge flywheel operations and status.

```
ao flywheel [command]
```

**Subcommands:**

#### `ao flywheel close-loop`

Close the knowledge flywheel loop by chaining:

```
ao flywheel close-loop [flags]
```

**Flags:**

```
  -h, --help                 help for close-loop
      --pending-dir string   Pending directory to ingest from (default ".agents/knowledge/pending")
      --quiet                Suppress non-essential output (hook-friendly)
      --threshold string     Minimum age for auto-promotion (default: 24h) (default "24h")
```

#### `ao flywheel nudge`

Returns structured JSON combining:

```
ao flywheel nudge [flags]
```

#### `ao flywheel status`

Display comprehensive flywheel health status.

```
ao flywheel status [flags]
```

**Flags:**

```
      --days int   Period in days for metrics calculation (default 7)
  -h, --help       help for status
```

---

### `ao inject`

Inject searches and outputs relevant knowledge for session startup.

```
ao inject [context] [flags]
```

**Flags:**

```
      --apply-decay      Apply confidence decay before ranking
      --context string   Context query for filtering (alternative to positional arg)
      --format string    Output format: markdown, json (default "markdown")
  -h, --help             help for inject
      --max-tokens int   Maximum tokens to output (default 1500)
      --no-cite          Disable citation recording
      --session string   Session ID for citation tracking (auto-generated if empty)
```

---

### `ao maturity`

Check and manage CASS (Contextual Agent Session Search) maturity levels.

```
ao maturity [learning-id] [flags]
```

**Flags:**

```
      --apply     Apply maturity transitions
      --archive   Move expired/evicted files to archive (requires --expire or --evict)
      --evict     Identify eviction candidates (composite criteria)
      --expire    Scan for expired learnings
  -h, --help      help for maturity
      --scan      Scan all learnings for pending transitions
```

---

### `ao metrics`

Track and report on knowledge flywheel metrics.

```
ao metrics [command]
```

**Subcommands:**

#### `ao metrics baseline`

Capture a baseline snapshot of the knowledge flywheel.

```
ao metrics baseline [flags]
```

**Flags:**

```
      --days int   Period in days for metrics calculation (default 7)
  -h, --help       help for baseline
```

#### `ao metrics cite`

Record that an artifact was cited in this session.

```
ao metrics cite <artifact-path> [flags]
```

**Flags:**

```
  -h, --help             help for cite
      --query string     Search query that surfaced this artifact
      --session string   Session ID (auto-detected if not provided)
      --type string      Citation type: recall, reference, applied (default "reference")
```

#### `ao metrics cite-report`

Produce an aggregated report from citation data.

```
ao metrics cite-report [flags]
```

**Flags:**

```
      --days int   Period in days (default 30)
  -h, --help       help for cite-report
      --json       Output as JSON (alias for -o json)
```

#### `ao metrics report`

Display a formatted report of knowledge flywheel metrics.

```
ao metrics report [flags]
```

**Flags:**

```
      --days int   Period in days for metrics calculation (default 7)
  -h, --help       help for report
```

---

### `ao trace`

Trace the provenance of an artifact back to its source transcript.

```
ao trace <artifact-path> [flags]
```

**Flags:**

```
      --graph   Show ASCII provenance graph
  -h, --help    help for trace
```

---

### `ao help`

Help provides help for any command in the application.

```
ao help [command] [flags]
```

---

