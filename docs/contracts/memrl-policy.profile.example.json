{
  "schema_version": 1,
  "default_mode": "off",
  "unknown_failure_class_action": "escalate",
  "missing_metadata_action": "escalate",
  "tie_break_rules": [
    "specificity: exact failure_class and exact attempt_bucket before wildcard matches",
    "priority: higher numeric priority wins within same specificity",
    "rule_id: lexical ascending as final deterministic tie-break"
  ],
  "rules": [
    {
      "rule_id": "off.vibe_fail.initial",
      "memrl_mode": "off",
      "failure_class": "vibe_fail",
      "attempt_bucket": "initial",
      "action": "retry",
      "priority": 100
    },
    {
      "rule_id": "off.vibe_fail.final",
      "memrl_mode": "off",
      "failure_class": "vibe_fail",
      "attempt_bucket": "final",
      "action": "escalate",
      "priority": 100
    },
    {
      "rule_id": "enforce.crank_blocked.initial",
      "memrl_mode": "enforce",
      "failure_class": "crank_blocked",
      "attempt_bucket": "initial",
      "action": "escalate",
      "priority": 100
    },
    {
      "rule_id": "enforce.vibe_fail.middle",
      "memrl_mode": "enforce",
      "failure_class": "vibe_fail",
      "attempt_bucket": "middle",
      "action": "retry",
      "priority": 100
    },
    {
      "rule_id": "observe.fallback",
      "memrl_mode": "observe",
      "failure_class": "*",
      "attempt_bucket": "*",
      "action": "escalate",
      "priority": 0
    }
  ],
  "rollback_matrix": [
    {
      "trigger_id": "enforce_escalation_rate_high",
      "metric": "escalation_rate",
      "metric_source_command": "ao rpi status --output json",
      "lookback_window": "24h",
      "min_sample_size": 10,
      "threshold": "escalation_rate > 0.35",
      "operator_action": "set MEMRL_MODE=observe and rerun from validation",
      "verification_command": "MEMRL_MODE=observe ao rpi status --output json"
    },
    {
      "trigger_id": "unknown_failure_class_ratio_high",
      "metric": "unknown_failure_class_ratio",
      "metric_source_command": "rg -n \"unknown_failure_class\" .agents/rpi/phase-*-result.json",
      "lookback_window": "48h",
      "min_sample_size": 5,
      "threshold": "unknown_failure_class_ratio > 0.10",
      "operator_action": "set MEMRL_MODE=off and open corrective issue for failure-class mapping",
      "verification_command": "MEMRL_MODE=off ao rpi status --output json"
    }
  ]
}
