version: 2
mission: "Make every coding agent session smarter than the last"
vision: "You define what good looks like. Your agent handles the rest — and gets better at it every time."
tagline: "The missing DevOps layer for coding agents. Flow, feedback, and memory that compounds between sessions."
pillars:
  - knowledge-compounding
  - validated-acceleration
  - goal-driven-automation
  - zero-friction-workflow
# Total: 35 goals
# Pruned 2026-02-21 per council consensus: feature saturation reached.
# Removed 58 grep-for-string-in-file-we-control goals, file-exists checks,
# keyword-in-README/SKILL.md goals, and duplicates (go-race-clean = go-cli-tests).
# Kept only goals that guard real mechanical invariants.
#
# Theoretical foundation (4 pillars → product pillars):
#   Systems Theory (Meadows)     → targets leverage points #3-#6
#   DevOps (Three Ways)          → Flow → zero-friction-workflow, goal-driven-automation
#                                  Feedback → validated-acceleration
#                                  Learning → knowledge-compounding
#   Brownian Ratchet             → chaos + filter + ratchet → validated-acceleration
#   Knowledge Flywheel (σ×ρ > δ) → escape velocity → knowledge-compounding
goals:
  # ============================================================================
  # SELF-HEALING (4 goals, weight 7)
  # Highest-weight goals. Prevent the failure modes that required manual pruning.
  # ============================================================================

  - id: no-stale-goals
    description: "No goals older than 90 days that are trivially true (grep-only checks that always pass)"
    check: "bash scripts/check-goal-staleness.sh"
    weight: 7
    added: "2026-02-19"

  - id: goal-quality
    description: "No goals that are pure grep-for-string-in-file-we-control patterns"
    check: "bash scripts/check-goal-quality.sh"
    weight: 7
    added: "2026-02-19"

  - id: product-freshness
    description: "PRODUCT.md is under 200 lines and last_reviewed within 30 days"
    check: "bash scripts/check-product-freshness.sh"
    weight: 7
    added: "2026-02-19"

  - id: pillar-coverage
    description: "GOALS.yaml has goals for all 4 product pillars"
    check: "bash scripts/check-pillar-coverage.sh"
    weight: 7
    type: meta
    added: "2026-02-21"

  # ============================================================================
  # BUILD INTEGRITY (4 goals, weight 3-5)
  # If these fail, nothing works. Fix immediately.
  # ============================================================================

  - id: go-cli-builds
    description: "Go CLI compiles without errors"
    check: "cd cli && go build -o /tmp/test-ao ./cmd/ao >/dev/null 2>&1"
    weight: 5
    added: "2026-02-19"

  - id: go-cli-tests
    description: "Go CLI unit tests pass (with race detector)"
    check: "cd cli && go test -race ./... >/dev/null 2>&1"
    weight: 5
    added: "2026-02-19"

  - id: full-test-suite
    description: "Full test suite passes (all tiers)"
    check: "./tests/run-all.sh"
    weight: 4
    added: "2026-02-19"

  - id: go-vet-clean
    description: "Go CLI passes vet checks (no common bugs)"
    check: "cd cli && go vet ./... 2>&1"
    weight: 3
    added: "2026-02-19"

  # ============================================================================
  # SECURITY (4 goals, weight 4)
  # Safety gates across all pipelines.
  # ============================================================================

  - id: hook-preflight
    description: "All hooks pass safety checks (kill switches, paths)"
    check: "./scripts/validate-hook-preflight.sh >/dev/null 2>&1"
    weight: 4
    added: "2026-02-19"

  - id: toolchain-security-gate
    description: "Unified security gate script is executable and testable"
    check: "test -x scripts/security-gate.sh && bash tests/scripts/test-security-gate.sh >/dev/null 2>&1"
    weight: 4
    added: "2026-02-19"

  - id: ci-security-toolchain-gate
    description: "Validate workflow enforces security toolchain gate"
    check: "grep -q 'security-toolchain-gate' .github/workflows/validate.yml && grep -q 'scripts/security-gate.sh' .github/workflows/validate.yml"
    weight: 4
    added: "2026-02-19"

  - id: release-security-gate
    description: "Release workflow requires security gate before build/publish"
    check: "grep -q '^  security-gate:' .github/workflows/release.yml && grep -q 'needs: \\[doc-release-gate, security-gate\\]' .github/workflows/release.yml && grep -q 'scripts/security-gate.sh' .github/workflows/release.yml"
    weight: 4
    added: "2026-02-19"

  # ============================================================================
  # QUALITY GATES (4 goals, weight 2-5)
  # Complexity, coverage, and lint checks that catch regressions.
  # ============================================================================

  # Complexity Goal Hierarchy:
  #   go-internal-complexity-ceiling: cli/internal/ packages only, strict threshold (CC < 8)
  #   go-absolute-complexity-ceiling: all of cli/, moderate threshold (CC < 10), absolute (all files)
  #   go-cmdao-complexity-tracking:   cli/cmd/ao/ only, same threshold as ceiling (CC < 10), weight 3
  #   go-complexity-gate:             pre-commit gate, delta-only (changed files), regression prevention
  #
  # Subsumption note:
  #   go-cmdao-complexity-tracking is fully subsumed by go-absolute-complexity-ceiling.
  #   Both check CC < 10, and cli/cmd/ao/ is a strict subset of cli/. Any violation caught by
  #   go-cmdao-complexity-tracking would also be caught by go-absolute-complexity-ceiling.
  #   Keeping go-cmdao-complexity-tracking for explicitness and lower weight (3 vs 5) — useful
  #   as a focused signal for cmd/ao/ specifically (e.g., per-area reporting, future tightening).
  #
  # Coverage summary by directory:
  #   cli/              → go-absolute-complexity-ceiling (CC<10, absolute) + go-complexity-gate (delta)
  #   cli/internal/     → go-internal-complexity-ceiling (CC<8, stricter) + above two
  #   cli/cmd/ao/       → go-cmdao-complexity-tracking (CC<10, redundant w/ ceiling) + above two
  - id: go-complexity-gate
    description: "Changed non-test Go code under cli/ stays below complexity failure threshold"
    check: "bash scripts/check-go-complexity.sh"
    weight: 5
    type: meta
    added: "2026-02-20"

  - id: go-coverage-floor
    description: "Go CLI average test coverage stays above 80%"
    check: "cd cli && go test -cover ./... 2>&1 | grep '^ok' | sed -n 's/.*coverage: \\([0-9.]*\\)%.*/\\1/p' | awk '{s+=$1;n++} END{if(n>0 && s/n>=80) exit 0; else exit 1}'"
    weight: 2
    added: "2026-02-19"

  - id: smoke-tests
    description: "Smoke tests pass (toolchain, skills, manifests)"
    check: "./tests/smoke-test.sh"
    weight: 3
    added: "2026-02-19"

  - id: opencode-live
    description: "OpenCode Tier 1 headless tests pass (gracefully skips if opencode not installed)"
    check: "bash scripts/check-opencode-live.sh"
    weight: 2
    pillar: validated-acceleration
    added: "2026-02-21"

  - id: go-absolute-complexity-ceiling
    description: "No Go function in cli/ has cyclomatic complexity >= 10 (absolute, not delta-only)"
    check: "bash scripts/check-go-absolute-complexity.sh --dir cli/ --threshold 10"
    weight: 5
    pillar: validated-acceleration
    added: "2026-02-22"

  - id: go-internal-complexity-ceiling
    description: "No Go function in cli/internal/ has cyclomatic complexity >= 8"
    check: "bash scripts/check-go-absolute-complexity.sh --dir cli/internal/ --threshold 8"
    weight: 4
    pillar: validated-acceleration
    added: "2026-02-22"

  - id: go-cmdao-complexity-tracking
    description: "No Go function in cli/cmd/ao/ has cyclomatic complexity >= 10"
    check: "bash scripts/check-go-absolute-complexity.sh --dir cli/cmd/ao/ --threshold 10"
    weight: 3
    pillar: validated-acceleration
    added: "2026-02-22"

  - id: go-per-package-coverage-floor
    description: "Every Go package under cli/ has test coverage >= 60% (per-package, not just average)"
    check: "bash scripts/check-go-per-package-coverage.sh --floor 60"
    weight: 3
    pillar: validated-acceleration
    added: "2026-02-22"

  # ============================================================================
  # SYSTEM HEALTH (5 goals, weight 2-6)
  # Goals subsystem, plugin versions, wiring integrity.
  # ============================================================================

  - id: ao-goals-builds
    description: "ao goals subcommand compiles and runs"
    check: "cd cli && go build -o /tmp/test-ao ./cmd/ao && /tmp/test-ao goals validate --json >/dev/null 2>&1"
    weight: 5
    added: "2026-02-19"

  - id: manifest-versions-match
    description: "Plugin and marketplace versions are in sync"
    check: "test \"$(jq -r '.metadata.version' .claude-plugin/marketplace.json)\" = \"$(jq -r '.version' .claude-plugin/plugin.json)\""
    weight: 3
    added: "2026-02-19"

  - id: wiring-closure
    description: "All scripts, skills, and hooks are referenced by their parent registries"
    check: "bash scripts/check-wiring-closure.sh"
    weight: 6
    type: meta
    added: "2026-02-19"

  - id: skill-validation
    description: "All skills have valid SKILL.md with frontmatter"
    check: "./tests/skills/run-all.sh"
    weight: 2
    added: "2026-02-19"

  - id: evolve-cycle-logging
    description: "Evolve cycle-history.jsonl has entries for all completed cycles with no gaps or missing fields"
    check: "bash scripts/check-evolve-cycle-logging.sh"
    weight: 6
    pillar: goal-driven-automation
    added: "2026-02-22"

  # ============================================================================
  # SKILLS HEALTH (2 goals, weight 3)
  # Core skill contracts and universal discoverability.
  # ============================================================================

  - id: skill-semantic-stability
    description: "Core skills have name, tier, and description in YAML frontmatter"
    check: "for s in council crank swarm rpi vibe pre-mortem post-mortem plan research implement evolve; do grep -q '^name:' skills/$s/SKILL.md && grep -q 'tier:' skills/$s/SKILL.md && grep -q '^description:' skills/$s/SKILL.md || exit 1; done"
    weight: 3
    added: "2026-02-19"

  - id: all-skills-have-frontmatter
    description: "Every SKILL.md has YAML frontmatter with name and description (required by all runtimes)"
    check: "bash -c 'for f in skills/*/SKILL.md; do head -5 \"$f\" | grep -q \"^---\" && head -10 \"$f\" | grep -q \"^name:\" && head -10 \"$f\" | grep -q \"^description:\" || { echo FAIL:$f; exit 1; }; done'"
    weight: 3
    pillar: zero-friction-workflow
    added: "2026-02-19"

  # ============================================================================
  # FEATURE-CRITICAL (5 goals, weight 3-5)
  # Guard the core features that make the system work.
  # ============================================================================

  - id: session-start-injects-knowledge
    description: "Session start hook injects prior knowledge automatically"
    check: "grep -qi 'inject\\|ao inject\\|knowledge' hooks/session-start.sh"
    weight: 4
    pillar: zero-friction-workflow
    added: "2026-02-19"

  - id: evolve-kill-switch
    description: "/evolve has documented kill switch (KILL and STOP files)"
    check: "grep -q 'KILL' skills/evolve/SKILL.md && grep -q 'STOP' skills/evolve/SKILL.md"
    weight: 4
    pillar: goal-driven-automation
    added: "2026-02-19"

  - id: rpi-phased-context-discipline
    description: "ao rpi phased includes context discipline and handoff instructions in every phase prompt"
    check: "cd cli && go build -o /tmp/test-ao-rpi ./cmd/ao >/dev/null 2>&1 && grep -rq 'phaseContextBudgets' cmd/ao/rpi_phased*.go"
    weight: 3
    pillar: zero-friction-workflow
    added: "2026-02-19"

  - id: telemetry-coverage
    description: "Orchestration skills log to skill-telemetry.jsonl"
    check: "grep -q 'log-telemetry.sh' skills/rpi/SKILL.md && grep -q 'log-telemetry.sh' skills/crank/SKILL.md && grep -q 'log-telemetry.sh' skills/evolve/SKILL.md"
    weight: 5
    type: meta
    added: "2026-02-19"

  - id: compaction-proofing
    description: "Orchestration skills commit checkpoints mid-workflow"
    check: "grep -q 'checkpoint-commit.sh' skills/rpi/SKILL.md && grep -q 'checkpoint-commit.sh' skills/crank/SKILL.md"
    weight: 5
    type: meta
    added: "2026-02-19"

  # ============================================================================
  # KNOWLEDGE COMPOUNDING (1 goal, weight 6)
  # The core product promise: sessions compound.
  # ============================================================================

  - id: flywheel-proof-passes
    description: "Flywheel proof run demonstrates 3-session compounding"
    check: "bash tests/e2e/proof-run.sh"
    weight: 6
    pillar: knowledge-compounding
    added: "2026-02-21"

  # ============================================================================
  # APPROACHABILITY (2 goals, weight 3)
  # Ensure new users can discover and start using AgentOps quickly.
  # ============================================================================

  - id: starter-skill-discoverability
    description: "README.md mentions the key starter skills (/quickstart, /status, /research, /vibe, /implement)"
    check: "grep -q '/quickstart' README.md && grep -q '/status' README.md && grep -q '/research' README.md && grep -q '/vibe' README.md && grep -q '/implement' README.md"
    weight: 3
    pillar: zero-friction-workflow
    added: "2026-02-22"

  - id: onboarding-path-completeness
    description: "Quickstart skill exists and is non-empty"
    check: "test -s skills/quickstart/SKILL.md"
    weight: 3
    pillar: zero-friction-workflow
    added: "2026-02-22"
